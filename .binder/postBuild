#!/bin/bash
set -e

echo "ğŸ“¦ Installing required packages..."
pip install --quiet ipywidgets notebook widgetsnbextension || echo "âš ï¸ Failed to install packages"

echo "ğŸ”Œ Enabling Jupyter Notebook widget extension (if available)..."
jupyter nbextension enable --py widgetsnbextension --sys-prefix || echo "âš ï¸ widgetsnbextension not available"

echo "ğŸ”Œ Installing JupyterLab widget manager extension (if using Lab)..."
jupyter labextension install @jupyter-widgets/jupyterlab-manager --no-build || echo "âš ï¸ labextension install failed (expected in some minimal Binder images)"

# Rebuild JupyterLab only if it's available
if jupyter lab --version > /dev/null 2>&1; then
    echo "ğŸ”§ Rebuilding JupyterLab..."
    jupyter lab build || echo "âš ï¸ JupyterLab rebuild failed"
fi

echo "âœ… postBuild complete"
